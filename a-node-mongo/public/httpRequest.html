<!DOCTYPE html>
<html>
  <head>
    <title>数据接口文档</title>
    <meta charset="UTF-8"/>
    <style>
    	*{margin: 0; padding: 0;}
    	table{border-top: 1px solid #666;border-left: 1px solid #666; table-layout: fixed}
    	table th{border-bottom: 1px solid #333;border-right: 1px solid #666; padding: 5px;}
    	table td{border-bottom: 1px solid #333;border-right: 1px solid #666; padding: 5px; word-wrap: break-word}
    	table code{display:block;}
    	table tbody tr:hover{ background: #eee;}
    </style>
    <script src="../js/jquery.js" type="text/javascript"></script>
  </head>
  <body style="padding:20px;">
  
    <h2>数据接口文档</h2>
      <div style="margin-top:20px;"><input type="button" value="打印" onclick="_print()" /></div>
      <div id="tableBox">
	      <table width="1000px" border="0" cellpadding="0" cellspacing="0">
	         <thead>
	             <tr>
	                 <th width="200px">URL</th>
	                 <th width="300px">参数</th>
	                 <th width="100px">动作</th>
	                 <th width="100px">请求</th>
	                 <th width="auto">说明</th>
	             </tr>
	         </thead>
	         <tbody>
	             <tr>
	                 <td><code>localhost:6001/nodejs/login</code></td>
	                 <td><code>action=signIn&whereJson={"username":"admin","password":"123456"}</code></td>
	                 <td><code>登录</code></td>
	                 <td><code>POST请求</code></td>
	                 <td><code>返回值为{"msg":"Success","UserName":"admin","Permission":1,"function":["Mfg", "Final", "Incoming"],token":"06ec605a1db57808efba5885019963b3"}; msg的值为"Success"或"UserName or Password error"或其它; 每次登陆成功时前端存储token，以后每次请求都要传送token</code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/login</code></td>
	                 <td><code>action=signOut&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>退出</code></td>
	                 <td><code>POST请求</code></td>
	                 <td><code>返回值为"Success"或其它</code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/login</code></td>
	                 <td><code>action=signUp&dataArr=[{"username":"xx", "password":"123456"}]</code></td>
	                 <td><code>注册用户</code></td>
	                 <td><code>POST请求</code></td>
	                 <td><code>返回值为"Success"或其它</code></td>
	             </tr>
	            <!--  <tr>
	                 <td><code>localhost:6001/nodejs/check</code></td>
	                 <td><code>action=check&idCode=1000001&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>校验</code></td>
	                 <td><code>GET请求</code></td>
	                 <td><code>返回值为"Success"或"No product"或其它</code></td>
	             </tr> -->
	             <tr>
	                 <td><code>localhost:6001/nodejs/check</code></td>
	                 <td><code>action=register&idCode=1000001&idCode2=1000002&data=[]&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>注册(4A)Mfg</code></td>
	                 <td><code>GET请求</code></td>
	                 <td><code>返回值为"Success"或"One-dimensional code already registered"或"Two-dimensional code already registered"或其它</code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/check</code></td>
	                 <td><code>action=check_register&idCode=1000001&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>验证注册</code></td>
	                 <td><code>GET请求</code></td>
	                 <td><code>返回值为"Already registered"或"No registered"或其它</code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/check</code></td>
	                 <td><code>action=updateMfgTest&idCode=1000001&idCode2=1000002&data=[]&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>更新Mfg Test Date</code></td>
	                 <td><code>GET请求</code></td>
	                 <td><code>返回值为"Success"或"Can not update"或其它</code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/check</code></td>
	                 <td><code>action=activate&idCode=1000001&serialNo=xxxx10xx&data=[]&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>激活(4B)Final</code></td>
	                 <td><code>GET请求</code></td>
	                 <td><code>返回值为"Success"或"Already activated"或其它</code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/check</code></td>
	                 <td><code>action=check_activate&idCode=1000001&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>验证激活</code></td>
	                 <td><code>GET请求</code></td>
	                 <td><code>返回值为"Already activated"或"No activated"或其它</code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/check</code></td>
	                 <td><code>action=check_idCodes&idCode=1000001&idCode2=1000002&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>检查(4C)Incoming</code></td>
	                 <td><code>GET请求</code></td>
	                 <td><code>返回值为{"msg":"idCode must not be null"}或{"msg":"Mfg Test Error", result: [{"code":"202", "value":"0", "name":"LCD test", "value2":"fail"}]}或{"msg":"Success"}或{"msg":"其它"}</code></code></td>
	             </tr>
	             
	             <!-- <tr>
	                 <td><code>localhost:6001/nodejs/deviceList</code></td>
	                 <td><code>action=findData&whereJson={}&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>查询</code></td>
	                 <td><code>GET请求</code></td>
	                 <td><code>whereJson={}查询所有的</code></td>
	             </tr> -->
	             <tr>
	                 <td><code>localhost:6001/nodejs/check</code></td>
	                 <td><code>action=findData&whereJson={"SerialNumber":"100000xxxx"}&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>registerList查询</code></td>
	                 <td><code>GET请求</code></td>
	                 <td><code>whereJson={}</code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/deviceList</code></td>
	                 <td><code>action=findData&whereJson={"SerialNumber":"100000xxxx"}&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>deviceList查询</code></td>
	                 <td><code>GET请求</code></td>
	                 <td><code>whereJson={}</code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/deviceList</code></td>
	                 <td><code>action=insertData&dataJson={"SerialNumber":"100000xxxx","PCBNumber":"xxxxxx","BluetoothNumber":"xxxxxx","UserInfo":{"PatientName":"xx","PatientEmail":"1533306@qq.com","DoctorEmail":"","DeviceName":"AVID IF2"},"Config":["0 hrs 0 min","English",0,false,false],"Usage":[],"Preset":[["No",null,2,"C",0,0,0,"OFF"],["No",null,2,"C",0,0,0,"OFF"],["No",null,2,"C",0,0,0,"OFF"],["No",null,2,"C",0,0,0,"OFF"],["No",null,2,"C",0,0,0,"OFF"],["No","normal",2,"C",100,20,1,"OFF"],["No","normal",2,"C",100,20,1,"OFF"],["No",null,4,"C",0,17,93,8],["No",null,4,"C",0,17,93,9],["No",null,4,"C",0,17,93,10],["No",null,4,"C",0,17,93,11],["No",null,4,"C",0,17,93,12],["No",null,4,"C",0,17,93,13],["No",null,4,"C",0,17,93,14],["No",null,4,"C",0,17,93,15],["No",null,4,"C",0,17,93,16],["No",null,4,"C",0,17,93,17],["No",null,4,"C",0,17,93,18],["No",null,4,"C",0,17,93,19],["No",null,4,"C",0,17,93,20]]}&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>deviceList新增</code></td>
	                 <td><code>POST请求</code></td>
	                 <td><code>返回值为"Success"或其它</code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/userList</code></td>
	                 <td><code>action=findData&whereJson={"user_name":"mick"}&fieldJson={"user_name":1}&prePageNum=10&currPage=1&sortJson={"key":1}&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>查询</code></td>
	                 <td><code>GET请求</code></td>
	                 <td><code>whereJson={}查询所有的</code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/userList</code></td>
	                 <td><code>action=insertData&dataArr=[{"user_name":"mick","password":"123456","permission":1,"permission_name":"admin"}]&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>增加</code></td>
	                 <td><code>POST请求</code></td>
	                 <td><code></code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/userList</code></td>
	                 <td><code>action=updateData&whereJson={"user_name":"admin"}&updateJson={"permission":1}&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>修改</code></td>
	                 <td><code>POST请求</code></td>
	                 <td><code></code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/userList</code></td>
	                 <td><code>action=delData&dataJson={"user_name":{"$in":["admin","mick"]}}&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>删除</code></td>
	                 <td><code>POST请求</code></td>
	                 <td><code>支持批量删除</code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/permission</code></td>
	                 <td><code>action=findData&whereJson={"permission":3}&fieldJson={"permission":1}&prePageNum=10&currPage=1&sortJson={"key":1}&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>查询</code></td>
	                 <td><code>GET请求</code></td>
	                 <td><code>whereJson={}查询所有的</code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/permission</code></td>
	                 <td><code>action=insertData&dataArr=[{"permission":1,"permission_name":"admin"}]&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>增加</code></td>
	                 <td><code>POST请求</code></td>
	                 <td><code></code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/permission</code></td>
	                 <td><code>action=updateData&whereJson={"permission":1}&updateJson={"permission_name":admin2}&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>修改</code></td>
	                 <td><code>POST请求</code></td>
	                 <td><code></code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/permission</code></td>
	                 <td><code>action=delData&dataJson={"permission":{"$in":[1]}}&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>删除</code></td>
	                 <td><code>POST请求</code></td>
	                 <td><code></code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/function</code></td>
	                 <td><code>action=findData&whereJson={"permission":1}&fieldJson={"permission":1}&prePageNum=10&currPage=1&sortJson={"key":1}&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>查询</code></td>
	                 <td><code>GET请求</code></td>
	                 <td><code></code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/function</code></td>
	                 <td><code>action=insertData&dataArr=[{"permission":1,"tableName":"permissions","action":"findData"}]&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>增加</code></td>
	                 <td><code>POST请求</code></td>
	                 <td><code></code></td>
	             </tr>
	             <tr>
	                 <td><code>localhost:6001/nodejs/function</code></td>
	                 <td><code>action=delData&dataJson={"permission":1,"tableName":"permissions","action":"findData"}&token=06ec605a1db57808efba5885019963b3</code></td>
	                 <td><code>删除</code></td>
	                 <td><code>POST请求</code></td>
	                 <td><code></code></td>
	             </tr>
	         </tbody>
	      </table>
      </div>
     
			
			<h4 style="margin-top:20px;">get请求</h4>
			<form name="form4">
			 <p>href:</p>
			 <p><input style="width: 300px" name="href" type="text" value="http://127.0.0.1:6001/nodejs/httpTest"></p>
			 <p>data:</p>
			 <p><textarea style="width: 300px;height: 150px;" name="data"></textarea></p>
			 <p><input type="button" value="提交" onclick="_get()"></p>
			</form>
			<br>
		
			<h4 style="margin-top:20px;">post请求</h4>
			<form name="form5">
			<p>href:</p>
			<p><input style="width: 300px" name="href" type="text" value="http://127.0.0.1:6001/nodejs/httpTest"></p>
			<p>data:</p>
			<p><textarea style="width: 300px;height: 150px;" name="data"></textarea></p>
			<p><input type="button" value="提交" onclick="_post()"></p>
			</form>
			<br>
		
			<!--<h4 style="margin-top:20px;">文件上传</h4>
			<form name="form6">
			<p>href:</p>
			<p><input style="width: 300px" name="href" type="text" value="http://192.168.218.202:6001/nodejs/fileList"></p>
			<p>data:</p>
			<p><textarea style="width: 300px;height: 50px;" name="dataJson"></textarea></p>
			<p><input id="file" type="file" name="file" multiple="multiple"/></p>
			<p><input type="button" value="上传文件" onclick="_uploadFile()"/></p>
			</form>-->


<script type="text/javascript">
    
    function _get() {
    	var href = $("form[name=form4] input[name=href").val();
    	var data = $("form[name=form4] textarea[name=data").val();
    	$.ajax({
              url: href+"?"+data,
              type: "GET",
              dataType:"html",
              xhrFields: {
	              withCredentials: true
	          },
              success: function (data,status,xhr) {
              	//console.log("请求成功");
                console.log(data);

              },
              error: function (xhr,status,error) {
                console.log("请求失败"); 
                //console.log(xhr); 
                //console.log(status); 
                //console.log(error); 
              }
    	});
    }

    
   
    function _post() {
      var href = $("form[name=form5] input[name=href").val();
    	var data = $("form[name=form5] textarea[name=data").val().replace(/[\n]+/g,"");

    	$.ajax({
              url: href,
              type: "POST",
              dataType:"html",
              data:data,
              xhrFields: {
                  withCredentials: true
              },
              success: function (data,status,xhr) {
              	//console.log("请求成功");
              	console.log(data);
              },
              error: function (xhr,status,error) {
              	console.log("请求失败"); 
                //console.log(xhr); 
                //console.log(status); 
                //console.log(error); 
              }
    	});
    }


    function _uploadFile() {
      var href = $("form[name=form6] input[name=href").val();
    	var formData = new FormData(document.forms['form6']);
    	var files = document.getElementById("file").files;
    	console.log(files);
    	formData.append("fileArr",files);
    	formData.append("action","insertData");
    	console.log("dataJson:"+formData.get("dataJson")+"action:"+formData.get("action"));

    	$.ajax({
              url: href,
              type: "POST",
              data:formData,
              contentType: false,  
              processData: false,  
              success: function (data,status,xhr) {
              	//console.log("请求成功");
              	console.log(data);
              },
              error: function (xhr,status,error) {
              	console.log("请求失败"); 
                //console.log(xhr); 
                //console.log(status); 
                //console.log(error); 
              }
    	});
    }


    
    function _print() {
		var windowObj = window.open('', 'PRINT', 'height=800, width=1000, scrollbars=yes, left=100');

		var orderNo = "2";
		var braceName = "Catalyst Elite"

		var html = '<html><head><title>数据接口文档</title><meta charset="UTF-8"/>'
		      +'<style>*{margin: 0; padding: 0;} table{border-top: 1px solid #666;border-left: 1px solid #666; table-layout: fixed} table th{border-bottom: 1px solid #333;border-right: 1px solid #666; padding: 5px;} table td{border-bottom: 1px solid #333;border-right: 1px solid #666; padding: 5px; word-wrap: break-word}table code{display:block;}'
		      +'</style></head>'
    	    +'<body>'
    	    + $("#tableBox").html()
    	    +'</body>'
    	    +'</html>';

		windowObj.document.write(html);
		windowObj.document.close(); // necessary for IE >= 10
		// windowObj.focus(); // necessary for IE >= 10*/
	  windowObj.print();
		// windowObj.close();
	}




</script>
    
</body>
</html>

